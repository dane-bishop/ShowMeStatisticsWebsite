<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}ShowMeStatistics{% endblock %}</title>


  <!-- STYLES -->

    <!-- Base Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base/tokens.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base/top_bar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base/page_layout.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base/calendar_favorites.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base/forms.css') }}">
    
    <!-- Home Page Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home/headline.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home/filters_sidebar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home/filter_buttons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home/calendar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home/event_card.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home/recent_games.css') }}">
    
    <!-- Teams Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/team/team_tabs.css') }}">
    
    <!-- Games Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/game/game_detail.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mobile/responsive.css') }}" />

    <!-- Profile Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile/profile.css') }}">

    <!-- Individual elements -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/elements/favorite_button.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/elements/cards.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/elements/button.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/elements/panel.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/elements/calendar_cards.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/elements/team_event_cards.css') }}">


    <!-- Dark Mode -->
    <link id="dark-theme" rel="stylesheet" href="{{ url_for('static', filename='css/dark/dark.css') }}" disabled>

</head>




<body>
    <!-- Top Left Dropdown Bar -->
    <header class="topbar">
      <div class="topbar-left">
          <button class="menu-dropdown" id="menuDropdownBtn">â˜°</button>
          <div class="dropdown" id="menuDropdown">
              <a href="{{ url_for('routes.home') }}">Home</a>
              <a href="{{ url_for('routes.news') }}">News</a>
              <a href="{{ url_for('routes.teams') }}">Teams</a>
              <a href="{{ url_for('routes.players') }}">Players</a>
              <a href="{{ url_for('routes.scores') }}">Scores</a>
          </div>

          <a href="/" class="brand">
              <img 
                  class="topbar-logo"
                  src="{{ url_for('static', filename='assets/logos/Missouri.png') }}" 
                  alt="Logo" 
                  onerror="this.style.display='none'" />
              <span>ShowMeStatistics</span>
          </a>
          
      </div>

      <!-- Search Bar -->
      <div class="search">
          <form class="search-form" action="{{ url_for('routes.search') }}" method="get">
              <input type="text" name="q" placeholder="Search teams, players, scores..." value="{{ request.args.get('q','') }}" />
              <button type="submit" class="search-btn"> ðŸ”Žï¸Ž </button>
          </form>
      </div>

      <!-- Profile -->
      <div class="topbar-right">
          {% if current_user.is_authenticated %}
            <span class="user-chip">Hi, {{ current_user.display_name or current_user.email }}</span>
            <a class="profile-btn" href="{{ url_for('routes.profile') }}">Profile</a>
            <form method="post" action="{{ url_for('auth.logout_submit') }}" style="display:inline">
              <button class="linklike" type="submit">Sign out</button>
            </form>
          {% else %}
            <a class="profile-btn" href="{{ url_for('auth.login_form') }}">Sign in/Register</a>
            <!--<a class="profile-btn" href="{{ url_for('auth.register_form') }}">Register</a>-->
          {% endif %}
        <div>
              <button id="toggle-theme" class="btn">O</button>
                <script>
                  const toggleBtn = document.getElementById('toggle-theme');
                  const darkTheme = document.getElementById('dark-theme');

                  // Always default to light mode unless localStorage says dark
                  function setInitialTheme() {
                    const darkEnabled = localStorage.getItem('dark-mode') === 'true';
                    darkTheme.disabled = !darkEnabled;
                  }

                  function updateThemeButton() {
                    const isDark = !darkTheme.disabled;
                    toggleBtn.textContent = isDark ? 'Light mode' : 'Dark mode';
                    toggleBtn.style.fontSize = '16px';
                    toggleBtn.style.fontFamily = 'inherit';
                  }

                  setInitialTheme();
                  updateThemeButton();

                  toggleBtn.addEventListener('click', () => {
                    // Toggle theme
                    darkTheme.disabled = !darkTheme.disabled;
                    // Save preference
                    localStorage.setItem('dark-mode', (!darkTheme.disabled).toString());
                    updateThemeButton();
                  });
                </script>
        </div>
      </div>
          
    </header>

    {% block banner %}{% endblock %}

    <main class="container">
        {% block content %}{% endblock %}
    </main>

    <script>
    // simple dropdown toggle
    const btn = document.getElementById('menuDropdownBtn');
    const menu = document.getElementById('menuDropdown');
    if (btn && menu) {
      btn.addEventListener('click', () => {
        menu.classList.toggle('open');
      });
      document.addEventListener('click', (e) => {
        if (!btn.contains(e.target) && !menu.contains(e.target)) {
          menu.classList.remove('open');
        }
      });
    }
    </script>
  
{% block scripts %}{% endblock %}
</body>
</html>